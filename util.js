/* Author: Sushovan Majhi (www.smajhi.com)
   Date: April 4, 2019
   ...
*/


// Globals
shapeSegments = [];
shape = [];
adjRips = [];
sample = [];
simplices = [[],[],[]];
dEps = [];
shadow=[];
shapeVisible   = true;
ballsVisible   = true;
complexVisible = true;
shadowVisible  = true;
H2Visible      = false;


// Compute new shape
function selectShape(name) {
    if(name !="")
	shape=Shape[name](center);
    else
	shape=[];
    // Draw the new shape
    shapeSegments=[shape];
    drawShape( );
    
}

// Sample the shape
function reSample(tol,size) {
    // if( shape.length==0 ) {
    // 	sample =  d3.range(size).map(function( ) {
    // 	    var x = d3.randomUniform(0,width)( );
    // 	    var y = d3.randomUniform(0,height)( );
    // 	    return [x,y];	
    // 	});
    // }
    
    // else {
    // 	sample =  d3.range(size).map(function(i) {
    // 	    var index = Math.floor(i*(shape.length-1)/size);
    // 	    var r = d3.randomUniform(tol)( );
    // 	    var s = d3.randomUniform(2*Math.PI)( );
    // 	    return [shape[index][0] + r*Math.cos(s), shape[index][1] +
    // 		    r*Math.sin(s)];
    // 	});
    //}
    sample = [
	[482785.900000, 4216659.100000],
[483396.700000, 4216956.200000],
[483290.600000, 4213439.600000],
[483345.200000, 4213574.900000],
[483368.100000, 4213621.400000],
[483390.100000, 4213689.100000],
[483386.800000, 4213792.400000],
[483362.500000, 4213908.000000],
[483361.600000, 4213909.300000],
[483314.400000, 4213962.700000],
[483080.200000, 4213985.200000],
[482997.800000, 4213994.200000],
[482983.700000, 4213986.600000],
[482981.000000, 4213952.400000],
[482927.400000, 4213909.300000],
[482715.100000, 4213913.100000],
[482487.900000, 4215480.900000],
[482612.800000, 4215712.600000],
[482737.700000, 4215908.700000],
[482937.900000, 4216085.700000],
[483049.600000, 4216238.700000],
[483152.400000, 4216380.700000],
[483162.100000, 4216388.300000],
[483170.000000, 4216391.600000],
[483200.600000, 4216330.600000],
[483154.600000, 4216130.900000],
[483096.000000, 4215799.200000],
[483103.400000, 4215567.300000],
[483111.200000, 4215531.700000],
[483121.600000, 4215460.600000],
[483125.800000, 4215376.300000],
[483201.800000, 4215283.900000],
[483518.600000, 4215359.900000],
[483717.700000, 4215361.600000],
[483766.800000, 4215345.800000],
[483809.800000, 4215325.800000],
[483821.100000, 4215320.300000],
[483828.100000, 4215303.800000],
[483802.600000, 4215241.600000],
[483769.200000, 4215176.100000],
[483754.000000, 4215053.000000],
[483707.900000, 4214811.400000],
[483583.700000, 4214520.800000],
[483531.600000, 4214313.500000],
[483426.800000, 4214120.700000],
[483398.900000, 4213802.500000],
[483292.200000, 4213498.800000],
[483317.400000, 4213522.900000],
[483363.200000, 4213600.700000],
[483373.500000, 4213904.600000],
[483478.500000, 4214202.800000],
[483587.900000, 4214531.000000],
[483748.200000, 4214905.700000],
[483820.800000, 4215255.100000],
[483829.600000, 4215281.800000],
[483795.500000, 4215320.800000],
[483505.400000, 4215337.000000],
[483297.700000, 4215455.100000],
[483105.100000, 4215597.700000],
[483091.300000, 4215720.900000],
[483148.200000, 4216063.600000],
[483174.800000, 4216205.800000],
[483204.800000, 4216334.400000],
[483209.700000, 4216363.200000],
[483321.600000, 4216614.800000],
[483593.900000, 4216864.000000],
[484812.300000, 4216875.200000],
[484635.400000, 4216976.700000],
[484073.300000, 4216923.600000],
[484164.200000, 4216811.200000],
[484231.700000, 4216776.800000],
[484232.500000, 4216776.800000],
[484280.800000, 4216817.800000],
[484424.400000, 4216718.900000],
[484530.200000, 4216622.200000],
[484655.700000, 4216652.000000],
[484605.400000, 4216501.000000],
[484671.100000, 4216459.800000],
[484776.900000, 4216316.500000],
[484783.900000, 4216303.400000],
[484782.200000, 4216325.400000],
[484683.400000, 4216445.400000],
[484535.400000, 4216505.800000],
[484533.700000, 4216505.800000],
[484512.700000, 4216514.700000],
[484509.100000, 4216513.400000],
[484488.000000, 4216500.400000],
[484462.500000, 4216420.400000],
[484433.300000, 4216289.700000],
[484428.100000, 4216269.800000],
[484427.100000, 4216262.600000],
[484375.000000, 4216073.100000],
[484421.400000, 4216040.800000],
[484460.100000, 4216025.100000],
[484462.700000, 4216023.800000],
[484516.200000, 4215990.300000],
[484394.000000, 4215880.500000],
[484393.700000, 4215720.900000],
[484390.900000, 4215637.500000],
[484283.000000, 4215606.800000],
[484146.100000, 4215562.600000],
[484025.700000, 4215435.500000],
[484023.100000, 4215432.100000],
[483996.700000, 4215369.900000],
[483928.000000, 4215238.000000],
[483956.300000, 4214884.900000],
[484048.400000, 4214453.000000],
[484090.200000, 4214285.400000],
[484131.100000, 4214131.200000],
[484162.300000, 4213913.600000],
[484163.900000, 4213893.700000],
[484127.200000, 4213513.300000],
[483358.800000, 4213602.000000],
[483397.800000, 4213740.700000],
[483371.900000, 4213935.000000],
[483378.200000, 4214006.100000],
[483544.700000, 4214354.100000],
[483703.500000, 4214789.800000],
[483744.400000, 4215094.900000],
[483826.400000, 4215282.200000],
[483675.700000, 4215360.400000],
[483399.400000, 4215361.000000],
[483194.500000, 4215534.500000],
[483087.800000, 4215712.000000],
[483152.600000, 4216070.400000],
[483196.000000, 4216261.200000],
[483216.400000, 4216350.100000],
[483274.600000, 4216521.800000],
[483512.900000, 4216832.000000],
[484783.400000, 4216858.300000],
[484622.200000, 4216986.000000],
[484040.700000, 4216836.400000],
[484146.600000, 4216811.700000],
[484232.500000, 4216773.800000],
[484267.700000, 4216794.900000],
[484281.800000, 4216816.900000],
[484316.900000, 4216814.700000],
[484371.900000, 4216739.300000],
[484371.800000, 4216685.100000],
[484456.800000, 4216618.500000],
[484532.300000, 4216621.700000],
[484609.500000, 4216680.400000],
[484685.500000, 4216577.000000],
[484646.700000, 4216456.000000],
[484772.700000, 4216330.500000],
[484777.800000, 4216299.600000],
[484777.800000, 4216297.500000],
[484798.800000, 4216244.100000],
[484771.800000, 4216402.900000],
[484538.700000, 4216503.200000],
[484136.700000, 4213410.400000],
[484149.500000, 4213673.200000],
[484154.800000, 4213769.700000],
[484160.200000, 4213847.600000],
[484133.300000, 4214080.800000],
[484074.100000, 4214316.300000],
[484006.200000, 4214607.200000],
[483944.500000, 4214879.000000],
[484006.400000, 4215144.300000],
[484102.200000, 4215283.800000],
[484098.000000, 4215360.400000],
[484004.300000, 4215421.500000],
[483988.600000, 4215437.200000],
[483923.000000, 4215485.200000],
[483824.800000, 4215492.200000],
[483750.000000, 4215379.300000],
[483653.500000, 4215387.100000],
[483433.300000, 4215353.300000],
[483289.700000, 4215483.500000],
[483288.900000, 4215483.500000],
[483278.400000, 4215491.100000],
[483119.900000, 4215599.000000],
[482909.600000, 4215665.000000],
[482616.900000, 4215756.600000],
[482440.100000, 4215874.700000],
[482760.800000, 4216645.200000],
[483039.900000, 4216783.400000],
[483279.100000, 4216749.500000],
[483372.000000, 4216696.000000],
[483380.700000, 4216696.000000],
[483473.900000, 4216814.300000],
[483578.300000, 4216835.200000],
[483738.600000, 4216804.000000],
[484012.000000, 4216709.100000],
[484055.500000, 4216546.900000],
[484095.500000, 4216404.600000],
[484336.400000, 4216261.900000],
[484354.800000, 4216249.600000],
[484354.800000, 4216248.300000],
[484403.900000, 4216235.100000],
[484400.300000, 4216183.900000],
[484248.800000, 4215823.600000],
[484108.100000, 4215623.200000],
[484094.000000, 4215607.600000],
[484044.700000, 4215542.100000],
[483949.800000, 4215445.800000],
[483873.400000, 4215353.700000],
[483867.200000, 4215348.200000],
[483862.700000, 4215311.400000],
[483952.800000, 4215153.700000],
[483978.300000, 4214782.900000],
[484082.600000, 4214327.700000],
[484096.600000, 4214258.700000],
[484140.100000, 4214095.600000],
[484160.100000, 4213965.700000],
[484161.600000, 4213895.800000],
[484129.300000, 4213531.900000],
[484817.600000, 4216902.300000],
[484539.900000, 4216603.100000],
[484449.200000, 4216393.800000],
[484421.700000, 4216255.000000],
[484372.200000, 4216073.100000],
[484508.000000, 4216012.700000],
[484401.700000, 4215884.300000],
[484404.000000, 4215646.800000],
[484408.000000, 4215471.600000],
[484428.500000, 4215198.500000],
[484431.700000, 4214994.500000],
[484405.100000, 4214830.300000],
[484453.900000, 4214653.700000],
[484419.500000, 4214466.300000],
[484201.600000, 4214233.500000],
[484132.900000, 4214129.500000],
[484161.500000, 4213942.000000],
[484160.500000, 4213851.000000],
[484135.100000, 4213439.200000],
[484148.000000, 4213614.800000],
[484167.900000, 4213973.300000],
[484134.200000, 4214158.700000],
[484048.000000, 4214491.600000],
[483971.600000, 4214857.800000],
[484000.200000, 4215137.500000],
[484104.900000, 4215296.100000],
[484068.300000, 4215403.600000],
[483991.300000, 4215451.600000],
[483979.100000, 4215451.600000],
[483858.100000, 4215521.700000],
[483766.700000, 4215397.500000],
[483717.500000, 4215356.500000],
[483598.200000, 4215363.500000],
[483392.200000, 4215379.600000],
[483294.200000, 4215472.100000],
[483243.500000, 4215511.100000],
[483108.700000, 4215601.100000],
[483004.400000, 4215632.200000],
[482707.300000, 4215725.100000],
[482656.500000, 4215744.300000],
[482610.900000, 4215756.600000],
[482406.800000, 4215868.000000],
[482543.300000, 4216530.900000],
[482789.100000, 4216651.500000],
[483016.400000, 4216764.000000],
[483225.100000, 4216784.700000],
[483381.000000, 4216694.700000],
[483454.700000, 4216782.100000],
[483665.200000, 4216822.800000],
[483904.400000, 4216761.400000],
[484099.600000, 4216625.500000],
[484020.400000, 4216457.200000],
[484218.300000, 4216329.400000],
[484376.800000, 4216238.100000],
[484379.500000, 4216234.800000],
[484426.900000, 4216270.200000],
[484534.500000, 4216596.300000],
[484872.800000, 4216947.400000],
[484768.500000, 4216852.000000],
[484534.700000, 4216604.000000],
[484495.100000, 4216527.400000],
[484428.900000, 4216260.100000],
[484389.800000, 4216047.200000],
[484385.500000, 4216036.200000],
[484514.300000, 4215977.200000],
[484395.700000, 4215863.100000],
[484400.500000, 4215657.800000],
[484277.600000, 4215586.100000],
[484124.900000, 4215514.400000],
[484024.700000, 4215397.000000],
[483941.100000, 4215276.100000],
[483922.700000, 4215261.700000],
[483952.300000, 4215158.400000],
[483974.300000, 4214810.800000],
[484016.900000, 4214598.700000],
[484097.900000, 4214248.900000],
[484127.400000, 4214145.600000],
[484162.300000, 4213992.300000],
[484165.600000, 4213871.300000],
[484153.900000, 4213744.700000],
[484134.200000, 4213486.200000],
[483285.500000, 4213405.700000],
[483342.900000, 4213571.100000],
[483385.200000, 4213633.200000],
[483399.500000, 4213758.500000],
[483373.400000, 4213862.700000],
[483365.800000, 4213982.500000],
[483492.600000, 4214234.000000],
[483579.100000, 4214509.000000],
[483707.700000, 4214798.200000],
[483747.800000, 4215101.200000],
[483826.200000, 4215276.300000],
[483857.900000, 4215324.900000],
[483975.700000, 4215445.700000],
[484100.500000, 4215604.200000],
[484275.400000, 4215850.200000],
[484416.400000, 4216208.400000],
[484457.100000, 4216394.600000],
[484497.600000, 4216519.800000],
[484741.000000, 4216797.900000],
[484956.500000, 4216996.000000],
[484649.200000, 4216713.800000],
[484508.500000, 4216555.300000],
[484507.700000, 4216542.200000],
[484488.400000, 4216488.100000],
[484430.000000, 4216247.400000],
[484426.500000, 4216231.700000],
[484424.800000, 4216231.700000],
[484400.900000, 4216129.700000],
[484390.200000, 4216040.900000],
[484516.300000, 4215987.300000],
[484408.300000, 4215873.200000],
[484405.300000, 4215728.100000],
[484405.000000, 4215596.000000],
[484406.300000, 4215388.600000],
[484428.700000, 4215182.000000],
[484435.300000, 4214987.700000],
[484488.700000, 4214893.200000],
[484521.800000, 4214782.300000],
[484498.900000, 4214711.200000],
[484342.700000, 4214667.100000],
[484381.000000, 4214491.800000],
[484345.700000, 4214367.400000],
[484221.800000, 4214233.500000],
[484175.300000, 4214214.500000],
[484135.600000, 4214113.400000],
[484166.800000, 4213904.700000],
[484166.700000, 4213858.100000],
[484162.300000, 4213808.200000],
[484144.300000, 4213618.600000],
[483481.900000, 4213459.900000],
[483485.400000, 4213488.700000],
[483485.400000, 4213498.900000],
[483497.700000, 4213539.900000],
[483593.400000, 4213602.800000],
[483814.400000, 4213594.700000],
[483988.300000, 4213753.100000],
[484130.400000, 4213770.600000],
[484140.900000, 4213769.300000],
[484122.900000, 4213540.800000],
[484158.300000, 4213742.200000],
[484169.900000, 4213867.400000],
[484171.600000, 4213864.100000],
[484000.700000, 4213902.100000],
[483716.500000, 4213928.000000],
[483464.800000, 4213953.100000],
[483429.700000, 4213957.400000],
[483378.800000, 4213966.400000],
[483400.100000, 4214048.400000],
[483344.000000, 4214118.400000],
[483339.300000, 4214372.300000],
[483232.000000, 4214632.000000],
[483144.500000, 4214718.500000],
[482949.200000, 4214453.600000],
[482963.500000, 4214169.500000],
[482787.200000, 4214168.600000],
[482652.200000, 4214186.700000],
[482429.500000, 4214206.200000],
[482498.900000, 4215479.200000],
[482638.000000, 4215745.200000],
[482798.800000, 4215967.900000],
[483082.400000, 4216150.600000],
[483150.800000, 4216183.900000],
[483165.700000, 4216187.200000],
[483164.900000, 4216187.200000],
[483220.500000, 4216381.400000],
[483314.700000, 4216585.200000],
[483523.900000, 4216838.700000],
[483747.400000, 4216801.500000],
[483971.700000, 4216724.400000],
[484128.500000, 4216658.500000],
[484410.400000, 4216479.300000],
[484420.100000, 4216475.900000],
[484457.700000, 4216451.300000],
[484459.400000, 4216451.300000],
[484472.500000, 4216438.200000],
[484406.300000, 4216149.600000],
[484280.300000, 4215862.500000],
[484260.000000, 4215821.500000],
[484243.200000, 4215788.100000],
[484216.800000, 4215733.900000],
[484189.500000, 4215695.000000],
[484142.900000, 4215649.800000],
[484059.400000, 4215557.700000],
[484022.500000, 4215507.900000],
[483901.200000, 4215389.600000],
[483863.500000, 4215335.500000],
[483872.100000, 4215299.900000],
[483961.900000, 4215041.100000],
[484015.400000, 4214612.700000],
[484104.200000, 4214221.800000],
[484162.400000, 4213961.000000],
[484176.400000, 4213914.400000],
[484168.300000, 4213811.200000],
[484145.900000, 4213569.500000],
[483282.700000, 4213428.200000],
[483340.900000, 4213571.100000],
[483375.100000, 4213634.100000],
[483391.000000, 4213714.900000],
[483362.500000, 4213900.400000],
[483362.500000, 4213922.400000],
[483434.900000, 4214156.300000],
[483571.500000, 4214473.500000],
[483727.500000, 4214861.700000],
[483829.300000, 4215289.800000],
[483965.600000, 4215452.500000],
[484001.600000, 4215494.800000],
[484189.700000, 4215699.700000],
[484382.400000, 4216092.100000],
[484496.300000, 4216521.100000],
[484740.600000, 4216812.200000],
[484776.800000, 4216852.400000],
[484501.900000, 4216554.500000],
[484501.800000, 4216546.900000],
[484482.500000, 4216490.200000],
[484420.700000, 4216239.800000],
[484425.000000, 4216238.500000],
[484421.400000, 4216218.600000],
[484295.400000, 4215902.700000],
[484152.000000, 4215669.700000],
[484097.500000, 4215613.100000],
[484034.300000, 4215534.500000],
[483878.800000, 4215375.200000],
[483854.900000, 4215334.200000],
[483911.900000, 4215276.600000],
[483964.200000, 4215112.200000],
[484086.000000, 4215051.900000],
[484231.400000, 4214978.400000],
[484395.200000, 4214901.500000],
[484470.700000, 4214943.600000],
[484518.600000, 4214790.300000],
[484499.200000, 4214718.400000],
[484335.200000, 4214673.400000],
[484383.000000, 4214468.100000],
[484275.600000, 4214293.000000],
[484211.400000, 4214236.400000],
[484167.600000, 4214222.100000],
[484136.600000, 4214094.800000],
[484163.500000, 4213908.500000],
[484162.500000, 4213857.300000],
[484129.300000, 4213445.500000],
[484157.200000, 4213696.100000],
[484169.100000, 4213966.900000],
[484131.800000, 4214126.600000],
[484091.700000, 4214283.200000],
[484024.700000, 4214535.200000],
[484016.900000, 4214585.200000],
[483955.400000, 4214959.000000],
[483967.000000, 4215082.200000],
[484010.100000, 4215146.400000],
[484054.900000, 4215215.300000],
[484128.700000, 4215322.700000],
[484047.200000, 4215394.800000],
[484050.800000, 4215416.800000],
[484214.100000, 4215554.000000],
[484421.100000, 4215598.900000],
[484530.300000, 4215856.100000],
[484522.800000, 4216063.500000],
[484506.300000, 4216141.400000],
[484513.300000, 4216170.200000],
[484563.600000, 4216330.900000],
[484640.900000, 4216423.000000],
[484746.900000, 4216383.900000],
[484777.500000, 4216280.600000],
[484777.500000, 4216306.000000],
[484622.600000, 4216462.900000],
[484498.300000, 4216514.300000],
[484499.100000, 4216515.600000],
[484477.100000, 4216482.200000],
[484434.700000, 4216303.600000],
[484362.000000, 4216338.100000],
[484119.400000, 4216487.100000],
[484085.900000, 4216380.500000],
[484004.300000, 4216351.900000],
[483919.200000, 4216374.000000],
[483966.000000, 4216562.700000],
[483484.600000, 4213502.300000],
[483555.000000, 4213625.300000],
[483780.200000, 4213582.500000],
[484002.400000, 4213757.300000],
[484139.300000, 4213772.700000],
[484129.200000, 4213564.000000],
[483284.100000, 4213451.400000],
[483323.800000, 4213551.300000],
[483386.200000, 4213645.500000],
[483386.600000, 4213838.500000],
[483373.500000, 4213892.700000],
[483382.500000, 4214072.600000],
[483326.800000, 4214313.500000],
[483272.000000, 4214501.100000],
[483202.200000, 4214655.400000],
[483250.900000, 4214909.200000],
[483149.000000, 4215205.700000],
[483144.700000, 4215236.600000],
[482888.600000, 4215224.900000],
[482527.300000, 4215207.800000],
[482417.800000, 4216480.800000],
[482881.200000, 4216710.500000],
[483346.400000, 4216941.500000],
[484895.000000, 4216970.700000],
[484579.600000, 4216648.300000],
[484501.400000, 4216556.200000],
[484501.400000, 4216552.000000],
[484451.000000, 4216387.800000],
[484421.000000, 4216239.300000],
[484421.000000, 4216238.100000],
[484400.600000, 4216147.100000],
[484466.100000, 4216016.200000],
[484470.200000, 4215927.300000],
[484407.800000, 4215824.100000],
[484403.100000, 4215614.600000],
[484410.600000, 4215429.200000],
[484428.500000, 4215184.100000],
[484439.500000, 4214977.600000],
[484502.300000, 4214853.000000],
[484405.800000, 4214819.700000],
[484425.700000, 4214692.300000],
[484350.100000, 4214601.500000],
[484383.100000, 4214424.000000],
[484218.800000, 4214225.900000],
[484128.400000, 4214204.000000],
[484151.800000, 4214017.700000],
[484159.500000, 4213937.700000],
[484160.200000, 4213872.100000],
[484155.700000, 4213804.400000],
[484147.700000, 4213692.300000],
[484876.000000, 4216859.800000],
[484672.200000, 4216624.000000],
[484548.500000, 4216565.400000],
[484483.300000, 4216399.200000],
[484402.100000, 4216081.100000],
[484247.300000, 4215846.000000],
[484281.300000, 4215788.400000],
[484245.200000, 4215702.100000],
[484112.700000, 4215689.300000],
[484107.400000, 4215653.700000],
[484131.700000, 4215479.300000],
[483981.400000, 4215336.500000],
[483935.600000, 4215271.000000],
[483775.600000, 4215070.700000],
[483732.000000, 4214761.400000],
[483601.700000, 4214481.000000],
[483570.600000, 4214342.200000],
[483516.000000, 4214221.300000],
[483396.200000, 4213950.700000],
[483424.700000, 4213754.200000],
[483385.000000, 4213618.800000],
[483310.000000, 4213422.600000],
[484127.100000, 4213465.000000],
[484163.800000, 4213814.500000],
[484168.200000, 4213857.700000],
[484163.100000, 4213872.100000],
[483981.600000, 4213900.400000],
[483797.500000, 4213934.200000],
[483595.800000, 4213949.000000],
[483401.100000, 4213973.900000],
[483394.000000, 4213967.200000],
[483340.500000, 4213967.300000],
[483135.300000, 4213984.200000],
[482985.200000, 4213984.500000],
[482987.800000, 4213957.800000],
[482994.800000, 4213918.000000],
[482768.400000, 4213918.500000],
[482699.700000, 4213770.100000],
[482695.100000, 4213660.100000],
[482694.600000, 4213420.500000],
[482778.800000, 4213430.500000],
[482806.400000, 4213587.900000],
[482800.200000, 4213594.700000],
[482801.400000, 4213750.000000],
[482801.700000, 4213886.300000],
[482574.500000, 4213913.400000],
[482432.000000, 4215394.700000],
[482548.200000, 4215612.900000],
[482676.700000, 4215845.800000],
[482858.500000, 4216036.300000],
[482986.700000, 4216159.200000],
[483081.700000, 4216292.300000],
[483150.200000, 4216383.200000],
[483114.300000, 4216408.700000],
[483098.600000, 4216421.800000],
[483101.900000, 4216306.300000],
[483187.000000, 4216286.200000],
[483261.100000, 4216520.100000],
[483503.700000, 4216831.600000],
[483719.400000, 4216807.900000],
[483865.800000, 4216773.300000],
[483917.400000, 4216753.300000],
[484045.200000, 4216695.500000],
[484250.100000, 4216508.800000],
[484172.700000, 4216352.400000],
[484403.900000, 4216222.000000],
[484375.500000, 4216054.500000],
[484454.400000, 4216023.400000],
[484494.700000, 4216019.900000],
[484402.300000, 4215888.100000],
[484402.800000, 4215714.900000],
[484284.900000, 4215589.900000],
[484112.000000, 4215501.300000],
[483991.600000, 4215347.500000],
[483923.000000, 4215242.200000],
[483953.900000, 4214881.600000],
[484064.300000, 4214384.400000],
[484153.200000, 4214030.400000],
[484162.600000, 4213918.300000],
[484157.200000, 4213773.900000],
[483270.800000, 4213412.500000],
[483270.000000, 4213449.400000],
[483289.400000, 4213514.900000],
[483314.900000, 4213557.200000],
[483336.900000, 4213594.000000],
[483349.700000, 4213854.700000],
[483401.900000, 4214107.700000],
[483503.900000, 4214287.400000],
[483572.800000, 4214526.800000],
[483714.600000, 4214848.200000],
[483737.900000, 4215081.300000],
[483795.200000, 4215240.800000],
[483809.300000, 4215271.700000],
[483899.100000, 4215404.800000],
[483959.700000, 4215452.500000],
[484060.800000, 4215582.300000],
[484123.200000, 4215648.600000],
[484335.300000, 4216015.600000],
[484436.800000, 4216391.700000],
[484741.000000, 4216826.200000],
[484886.500000, 4216939.000000],
[484518.400000, 4216548.100000],
[484477.900000, 4216446.200000],
[484406.400000, 4216246.600000],
[484378.900000, 4216269.900000],
[484346.500000, 4216305.500000],
[484265.900000, 4216282.400000],
[484401.700000, 4216224.600000],
[484407.900000, 4216223.300000],
[484369.000000, 4216064.600000],
[484448.700000, 4216014.500000],
[484450.300000, 4216013.300000],
[484491.300000, 4215947.600000],
[484394.500000, 4215780.100000],
[484336.300000, 4215571.600000],
[484145.000000, 4215541.900000],
[484016.800000, 4215414.800000],
[483993.000000, 4215352.600000],
[483921.700000, 4215258.300000],
[483960.800000, 4215054.200000],
[483960.800000, 4215054.200000],
[483980.400000, 4214744.800000],
[483989.000000, 4214702.500000],
[484004.600000, 4214633.400000],
[484086.400000, 4214289.200000],
[484096.900000, 4214260.400000],
[484124.800000, 4214142.600000],
[484153.600000, 4214062.600000],
[484163.200000, 4214012.600000],
[484163.000000, 4213941.500000],
[484164.700000, 4213921.600000],
[484141.300000, 4213613.100000],
[484172.800000, 4213817.900000],
[484175.600000, 4213875.500000],
[483948.500000, 4213908.100000],
[483577.500000, 4213946.500000],
[483393.400000, 4213968.900000],
[483389.900000, 4213971.000000],
[483242.500000, 4213985.700000],
[482994.300000, 4214010.700000],
[482991.500000, 4213939.600000],
[482989.800000, 4213926.500000],
[482771.500000, 4213933.700000],
[482691.400000, 4213789.600000],
[482687.600000, 4213656.300000],
[482683.600000, 4213433.200000],
[482780.200000, 4213452.900000],
[482798.100000, 4213606.900000],
[482807.100000, 4213744.500000],
[482815.200000, 4213895.600000],
[482681.100000, 4213913.600000],
[482465.200000, 4215409.900000],
[482587.600000, 4215644.900000],
[482665.000000, 4215789.100000],
[482826.800000, 4215988.600000],
[483020.000000, 4216182.400000],
[483118.500000, 4216315.600000],
[483108.100000, 4216404.500000],
[483109.800000, 4216408.700000],
[483074.700000, 4216426.500000],
[483172.000000, 4216411.900000],
[483177.200000, 4216416.200000],
[483221.200000, 4216470.300000],
[483345.100000, 4216648.600000],
[483605.000000, 4216824.600000],
[483758.500000, 4216796.400000],
[483879.500000, 4216763.900000],
[483958.300000, 4216729.500000],
[484038.900000, 4216697.200000],
[484240.300000, 4216533.800000],
[484150.500000, 4216382.100000],
[484267.900000, 4216303.100000],
[484402.800000, 4216240.600000],
[484357.800000, 4216065.500000],
[484445.300000, 4216031.000000],
[484470.700000, 4216022.100000],
[484392.400000, 4215901.200000],
[484388.400000, 4215662.500000],
[484210.400000, 4215605.300000],
[484040.800000, 4215460.400000],
[483936.100000, 4215295.100000],
[483937.600000, 4215195.200000],
[483988.400000, 4214713.500000],
[484054.300000, 4214403.900000],
[484066.400000, 4214347.200000],
[484069.100000, 4214334.900000],
[484083.900000, 4214286.200000],
[484083.900000, 4214282.000000],
[484097.000000, 4214229.900000],
[484099.600000, 4214201.100000],
[484155.200000, 4213895.800000],
[484139.100000, 4213705.000000],
[483313.700000, 4213537.700000],
[483361.200000, 4213609.600000],
[483401.700000, 4213703.900000],
[483371.600000, 4214013.400000],
[483302.700000, 4214211.200000],
[483290.100000, 4214511.700000],
[483208.200000, 4214790.400000],
[483202.600000, 4215073.100000],
[483133.700000, 4215265.400000],
[482856.500000, 4215244.000000],
[482467.900000, 4215225.700000],
[482609.100000, 4216574.400000],
[483137.500000, 4216838.700000],
[484816.700000, 4216882.400000],
[484518.900000, 4216562.100000],
[484508.400000, 4216545.600000],
[484447.400000, 4216345.100000],
[484425.300000, 4216233.000000],
[484424.500000, 4216233.000000],
[484396.200000, 4216126.400000],
[484377.600000, 4216047.700000],
[484513.500000, 4216000.900000],
[484392.200000, 4215876.700000],
[484396.100000, 4215661.200000],
[484407.100000, 4215451.700000],
[484431.200000, 4215160.000000],
[484447.500000, 4214980.100000],
[484508.600000, 4214828.000000],
[484532.300000, 4214759.000000],
[484437.500000, 4214702.400000],
[484343.500000, 4214639.600000],
[484387.800000, 4214445.200000],
[484303.400000, 4214322.200000],
[484218.100000, 4214233.500000],
[484146.100000, 4214209.100000],
[484155.500000, 4214013.900000],
[484160.300000, 4213848.400000],
[484130.800000, 4213542.000000],
[483340.900000, 4213565.600000],
[483382.500000, 4213814.000000],
[483366.000000, 4213932.500000],
[483408.500000, 4214073.400000],
[483568.000000, 4214446.800000],
[483726.700000, 4214843.500000],
[483747.400000, 4215102.100000],
[483787.100000, 4215194.300000],
[483826.700000, 4215272.900000],
[483829.400000, 4215280.500000],
[483884.800000, 4215371.400000],
[483956.000000, 4215433.500000],
[483997.200000, 4215490.100000],
[484121.100000, 4215637.600000],
[484320.800000, 4215965.700000],
[484432.000000, 4216326.100000],
[484536.900000, 4216581.100000],
[484776.700000, 4216839.300000],
[484672.900000, 4216733.200000],
[484474.200000, 4216444.900000],
[484396.800000, 4216265.200000],
[484383.800000, 4216273.300000],
[484311.100000, 4216328.800000],
[484396.000000, 4216223.300000],
[484393.200000, 4216117.900000],
[484464.000000, 4216016.600000],
[484469.200000, 4216013.200000],
[484440.900000, 4215903.200000],
[484406.400000, 4215711.100000],
[484297.500000, 4215586.900000],
[484155.400000, 4215547.400000],
[484038.600000, 4215421.100000],
[483984.900000, 4215313.700000],
[483936.600000, 4215258.300000],
[483968.700000, 4215097.400000],
[483965.200000, 4215096.100000],
[483954.300000, 4214933.200000],
[483988.000000, 4214703.300000],
[483988.000000, 4214696.500000],
[484039.200000, 4214461.100000],
[484101.000000, 4214222.300000],
[484110.600000, 4214193.500000],
[484153.300000, 4214031.300000],
[484163.600000, 4213871.700000],
[484153.700000, 4213779.400000],
[484133.800000, 4213459.900000],
[484141.200000, 4213454.800000],
[484159.200000, 4213691.000000],
[484159.300000, 4213727.800000],
[484169.200000, 4213858.600000],
[484119.700000, 4214137.200000],
[484075.400000, 4214315.900000],
[484020.600000, 4214530.100000],
[483992.800000, 4214686.800000],
[483958.500000, 4215080.900000],
[483976.100000, 4215100.800000],
[484041.200000, 4215195.000000],
[484131.700000, 4215330.300000],
[484044.200000, 4215405.000000],
[484044.300000, 4215409.200000],
[484155.900000, 4215544.400000],
[484390.100000, 4215579.500000],
[484488.700000, 4215771.500000],
[484556.600000, 4215976.700000],
[484505.300000, 4216146.500000],
[484515.900000, 4216186.200000],
[484559.100000, 4216330.500000],
[484634.700000, 4216424.700000],
[484767.000000, 4216320.400000],
[484777.500000, 4216282.700000],
[484778.300000, 4216295.800000],
[484649.700000, 4216449.300000],
[484498.100000, 4216512.600000],
[484497.300000, 4216514.700000],
[484480.500000, 4216488.100000],
[484422.200000, 4216260.900000],
[484350.400000, 4216332.200000],
[484112.200000, 4216492.200000],
[484067.300000, 4216364.900000],
[483997.300000, 4216354.000000],
[483920.300000, 4216423.100000],
[483967.100000, 4216596.200000],
[483997.100000, 4216699.400000],
[484038.500000, 4216832.600000],
[484188.400000, 4216798.900000],
[484233.000000, 4216768.800000],
[484297.000000, 4216731.800000],
[484375.100000, 4216757.100000],
[484472.300000, 4216670.500000],
[484546.800000, 4216621.700000],
[484810.400000, 4216898.500000],
[483693.200000, 4216953.100000],
[483694.100000, 4216953.100000],
[484924.400000, 4216983.800000],
[484568.700000, 4216625.100000],
[484516.900000, 4216562.100000],
[484449.000000, 4216360.300000],
[484396.900000, 4216125.100000],
[484437.800000, 4216041.600000],
[484498.200000, 4215963.600000],
[484406.800000, 4215815.300000],
[484349.400000, 4215597.000000],
[484160.000000, 4215584.200000],
[484019.400000, 4215432.500000],
[483928.800000, 4215282.900000],
[483958.100000, 4215044.100000],
[484024.700000, 4214569.100000],
[484138.000000, 4214154.100000],
[484169.200000, 4213958.900000],
[483966.600000, 4213943.600000],
[483692.100000, 4213959.800000],
[483416.800000, 4213978.100000],
[483408.100000, 4213976.000000],
[483372.000000, 4213919.400000],
[483397.200000, 4213797.400000],
[483329.300000, 4213620.200000],
[483325.700000, 4213572.400000],
[483362.500000, 4213568.900000],
[483434.400000, 4213557.800000],
[483509.900000, 4213607.600000],
[483686.200000, 4213592.800000],
[483910.100000, 4213684.700000],
[484024.400000, 4213798.700000],
[484117.400000, 4213785.400000],
[484126.900000, 4213707.500000],
[483295.200000, 4213470.500000],
[483362.000000, 4213611.300000],
[483394.800000, 4213737.800000],
[483366.200000, 4213932.100000],
[483370.600000, 4213975.300000],
[483505.400000, 4214251.400000],
[483603.400000, 4214597.400000],
[483756.700000, 4214983.100000],
[483830.100000, 4215278.000000],
[483859.100000, 4215316.900000],
[483995.300000, 4215460.900000],
[484112.200000, 4215608.400000],
[484302.100000, 4215884.400000],
[484434.200000, 4216264.700000],
[484518.100000, 4216541.800000],
[484824.700000, 4216876.400000],
[484693.200000, 4216761.100000],
[484509.500000, 4216549.400000],
[484489.200000, 4216508.400000],
[484482.200000, 4216500.800000],
[484443.300000, 4216368.800000],
[484380.100000, 4216269.000000],
[484385.300000, 4216279.200000],
[484345.100000, 4216355.900000],
[484286.300000, 4216304.800000],
[484403.800000, 4216235.600000],
[484419.500000, 4216236.800000],
[484384.100000, 4216081.500000],
[484469.100000, 4216018.300000],
[484518.200000, 4215975.900000],
[484399.500000, 4215840.700000],
[484384.200000, 4215606.600000],
[484231.600000, 4215589.100000],
[484053.300000, 4215440.900000],
[484023.500000, 4215410.900000],
[483949.700000, 4215296.800000],
[483932.100000, 4215273.500000],
[483934.600000, 4215187.200000],
[483948.300000, 4215016.200000],
[483948.300000, 4215016.200000],
[483941.100000, 4214905.300000],
[483980.200000, 4214712.200000],
[483980.200000, 4214710.100000],
[484020.100000, 4214533.500000],
[484103.600000, 4214183.700000],
[484156.600000, 4213925.000000],
[484155.700000, 4213880.600000],
[484114.600000, 4213493.400000],
[484122.800000, 4213540.800000],
[484148.700000, 4213808.200000],
[484123.800000, 4214075.800000],
[484105.500000, 4214147.800000],
[484060.200000, 4214336.600000],
[483975.800000, 4214706.300000],
[483944.900000, 4215086.000000],
[483965.300000, 4215125.800000],
[484024.100000, 4215209.900000],
[484115.500000, 4215343.000000],
[484027.100000, 4215425.300000],
[484043.800000, 4215455.300000],
[484224.700000, 4215589.200000],
[484398.400000, 4215607.900000],
[484494.300000, 4215810.900000],
[484549.800000, 4216010.500000],
[484504.500000, 4216158.300000],
[484512.500000, 4216237.000000],
[484566.300000, 4216394.400000],
[484649.600000, 4216431.900000],
[484765.900000, 4216284.000000],
[484779.100000, 4216244.200000],
[484777.400000, 4216274.200000],
[484719.900000, 4216427.500000],
[484521.000000, 4216505.800000],
[484517.500000, 4216509.200000],
[484493.800000, 4216518.100000],
[484454.100000, 4216418.300000],
[484383.800000, 4216283.000000],
[484271.800000, 4216394.100000],
[484108.800000, 4216465.500000],
[484062.100000, 4216339.100000],
[483972.700000, 4216361.200000],
[483944.000000, 4216502.200000],
[483993.600000, 4216700.700000],
[483991.900000, 4216700.700000],
[484028.100000, 4216825.000000],
[484239.700000, 4216925.800000],
[484521.100000, 4216899.900000],
[484747.300000, 4216863.900000],
[484763.000000, 4216851.600000],
[484869.200000, 4216949.100000],
[484747.500000, 4216826.200000],
[484462.600000, 4216420.800000],
[484424.700000, 4216234.700000],
[484380.500000, 4216046.000000],
[484528.500000, 4215974.600000],
[484411.700000, 4215846.100000],
[484406.900000, 4215612.100000],
[484242.000000, 4215592.500000],
[484097.900000, 4215476.400000],
[483983.500000, 4215323.400000],
[483938.700000, 4215255.800000],
[483928.200000, 4215252.400000],
[483956.700000, 4215010.700000],
[484018.900000, 4214578.000000],
[484105.000000, 4214209.600000],
[484109.300000, 4214207.400000],
[484165.900000, 4213978.800000],
[484166.600000, 4213904.300000],
[484160.200000, 4213782.400000],
[484796.900000, 4216862.900000],
[484520.100000, 4216560.400000],
[484488.400000, 4216500.400000],
[484378.900000, 4216095.500000],
[484502.300000, 4216007.700000],
[484390.700000, 4215872.400000],
[484387.600000, 4215638.400000],
[484253.400000, 4215598.800000],
[484078.700000, 4215488.300000],
[483963.500000, 4215337.400000],
[483922.100000, 4215208.800000],
[483955.500000, 4214843.900000],
[484031.100000, 4214478.900000],
[484089.300000, 4214248.100000],
[484151.100000, 4213992.800000],
[484150.900000, 4213912.800000],
[484141.900000, 4213721.900000],
[483327.200000, 4213521.200000],
[483370.400000, 4213592.200000],
[483366.900000, 4213594.300000],
[483369.600000, 4213606.600000],
[483406.600000, 4213709.800000],
[483405.900000, 4213775.400000],
[483382.300000, 4213889.700000],
[483456.500000, 4214166.800000],
[483607.400000, 4214566.100000],
[483764.200000, 4214944.200000],
[483791.900000, 4215191.700000],
[483841.300000, 4215282.600000],
[484025.000000, 4215495.200000],
[484251.800000, 4215771.100000],
[484427.100000, 4216211.400000],
[484559.300000, 4216612.800000],
[484874.700000, 4216937.300000],
[484072.600000, 4216927.400000],
[484104.000000, 4216819.800000],
[484194.300000, 4216793.000000],
[484226.700000, 4216771.700000],
[484227.500000, 4216771.700000],
[484278.400000, 4216805.900000],
[484375.600000, 4216757.100000],
[484465.800000, 4216671.400000],
[484535.700000, 4216608.200000],
[484634.800000, 4216653.300000],
[484650.300000, 4216536.900000],
[484662.400000, 4216445.900000],
[484775.200000, 4216320.400000],
[484777.800000, 4216308.100000],
[484782.200000, 4216308.100000],
[484797.800000, 4216272.500000],
[484763.900000, 4216385.600000],
[484579.100000, 4216480.300000],
[484527.500000, 4216503.700000],
[484510.800000, 4216513.900000],
[484488.900000, 4216501.600000],
[484457.100000, 4216412.800000],
[484401.600000, 4216258.800000],
[484393.400000, 4216262.200000],
[484360.300000, 4216333.400000],
[484286.700000, 4216308.200000],
[484370.700000, 4216242.400000],
[484393.200000, 4216142.500000],
[484407.900000, 4216044.700000],
[484454.400000, 4216024.700000],
[484468.300000, 4215941.300000],
[484403.200000, 4215838.100000],
[484402.800000, 4215670.500000],
[484276.500000, 4215617.400000],
[484098.300000, 4215511.100000],
[484027.100000, 4215443.500000],
[484020.900000, 4215424.500000],
[483926.800000, 4215285.000000],
[483955.300000, 4215095.300000],
[483975.800000, 4214763.400000],
[484062.700000, 4214378.100000],
[484097.500000, 4214231.600000],
[484141.000000, 4214074.100000],
[484149.500000, 4213950.900000],
[484144.800000, 4213763.400000],
[484144.000000, 4213608.500000],
[484137.800000, 4214044.400000],
[484067.300000, 4214335.300000],
[483981.200000, 4214712.600000],
[483967.900000, 4215106.700000],
[484052.300000, 4215233.100000],
[484131.400000, 4215346.000000],
[484112.200000, 4215363.800000],
[484058.000000, 4215439.200000],
[484234.600000, 4215570.900000],
[484412.600000, 4215600.600000],
[484472.500000, 4215732.600000],
[484549.200000, 4215917.800000],
[484527.500000, 4216055.400000],
[484509.300000, 4216135.500000],
[484509.300000, 4216141.000000],
[484547.200000, 4216315.300000],
[484613.200000, 4216439.600000],
[484724.500000, 4216405.900000],
[484770.800000, 4216284.000000],
[484770.800000, 4216282.700000],
[484780.400000, 4216262.800000],
[484776.200000, 4216322.900000],
[484771.900000, 4216342.800000],
[484640.600000, 4216434.000000],
[484525.000000, 4216485.500000],
[484526.700000, 4216492.200000],
[484514.500000, 4216503.300000],
[484514.500000, 4216507.500000],
[484489.900000, 4216494.400000],
[484463.500000, 4216416.600000],
[484395.600000, 4216253.800000],
[484291.500000, 4216369.500000],
[484108.400000, 4216476.500000],
[484075.800000, 4216391.100000],
[484072.200000, 4216385.600000],
[484002.900000, 4216348.100000],
[483967.000000, 4216357.000000],
[483940.000000, 4216490.400000],
[483991.200000, 4216670.200000],
[484031.500000, 4216698.000000],
[484191.800000, 4216637.600000],
[484234.100000, 4216705.300000],
[484235.800000, 4216745.100000],
[484235.800000, 4216752.700000],
[484148.300000, 4216795.200000],
[484056.300000, 4216865.200000],
[483075.900000, 4216841.300000],
[482577.400000, 4216590.500000],
[484767.200000, 4216816.400000],
[484502.800000, 4216509.600000],
[484424.100000, 4216204.600000],
[484461.300000, 4216001.400000],
[484434.900000, 4215880.400000],
[484409.200000, 4215738.200000],
[484354.500000, 4215584.300000],
[484178.200000, 4215570.200000],
[484070.100000, 4215451.900000],
[483973.300000, 4215317.900000],
[483924.000000, 4215262.600000],
[483951.700000, 4215037.300000],
[483947.000000, 4214879.900000],
[484053.200000, 4214399.300000],
[484112.400000, 4214170.600000],
[484154.300000, 4213993.200000],
[484138.900000, 4213757.900000],
[483324.000000, 4213475.100000],
[483318.800000, 4213481.800000],
[483363.600000, 4213574.000000],
[483404.100000, 4213663.700000],
[483402.700000, 4213788.100000],
[483395.800000, 4213842.300000],
[483391.800000, 4214017.500000],
[483524.800000, 4214288.200000],
[483629.900000, 4214649.800000],
[483771.000000, 4215011.400000],
[483820.700000, 4215254.300000],
[483929.700000, 4215425.900000],
[484099.300000, 4215597.400000],
[484314.800000, 4215881.000000],
[484459.400000, 4216316.700000],
[484703.100000, 4216743.300000],
[484106.000000, 4216975.100000],
[484074.900000, 4216827.500000],
[484229.200000, 4216769.600000],
[484258.900000, 4216769.600000],
[484338.800000, 4216797.300000],
[484456.900000, 4216680.700000],
[484535.700000, 4216611.600000],
[484557.600000, 4216601.400000],
[484662.900000, 4216623.200000],
[484611.800000, 4216476.800000],
[484728.200000, 4216411.000000],
[484780.700000, 4216298.800000],
[484782.300000, 4216298.800000],
[484794.500000, 4216268.700000],
[484791.800000, 4216281.800000],
[484761.300000, 4216407.200000],
[484541.400000, 4216499.800000],
[484510.600000, 4216512.200000],
[484507.100000, 4216512.200000],
[484481.600000, 4216475.400000],
[484419.800000, 4216247.000000],
[484407.600000, 4216257.100000],
[484383.300000, 4216302.900000],
[484372.600000, 4216234.300000],
[484419.100000, 4216234.300000],
[484383.700000, 4216093.400000],
[484428.300000, 4216034.500000],
[484475.600000, 4216011.100000],
[484434.200000, 4215907.000000],
[484404.200000, 4215762.800000],
[484346.000000, 4215586.400000],
[484166.200000, 4215577.800000],
[484050.200000, 4215444.700000],
[484023.800000, 4215411.400000],
[483944.700000, 4215290.500000],
[483937.500000, 4215199.500000],
[483968.400000, 4214832.000000],
[484072.700000, 4214370.000000],
[484107.600000, 4214237.900000],
[484107.500000, 4214234.500000],
[484162.300000, 4213997.000000],
[484157.600000, 4213813.700000],
[484133.400000, 4213575.000000],
[484133.800000, 4213449.800000],
[484156.300000, 4213770.500000],
[484150.600000, 4213995.700000],
[484112.200000, 4214152.400000],
[484060.000000, 4214367.900000],
[483980.800000, 4214713.100000],
[483949.100000, 4215057.200000],
[484048.400000, 4215217.900000],
[484129.200000, 4215337.500000],
[484107.400000, 4215362.100000],
[484105.000000, 4215489.500000],
[484297.100000, 4215559.000000],
[484449.900000, 4215679.700000],
[484544.900000, 4215902.600000],
[484526.000000, 4216075.800000],
[484512.900000, 4216132.500000],
[484512.900000, 4216136.700000],
[484525.300000, 4216225.600000],
[484553.600000, 4216341.900000],
[484630.100000, 4216442.900000],
[484759.700000, 4216372.900000],
[484777.100000, 4216290.700000],
[484798.900000, 4216228.500000],
[484767.600000, 4216388.100000],
[484546.900000, 4216490.500000],
[484522.300000, 4216502.800000],
[484496.900000, 4216509.700000],
[484488.200000, 4216499.500000],
[484423.700000, 4216260.900000],
[484368.600000, 4216287.700000],
[484210.900000, 4216414.500000],
[484088.200000, 4216436.800000],
[484063.400000, 4216324.700000],
[483997.700000, 4216342.600000],
[483924.200000, 4216363.900000],
[483944.700000, 4216493.800000],
[483988.800000, 4216656.600000],
[484001.100000, 4216706.600000],
[484152.700000, 4216635.200000],
[484231.700000, 4216690.500000],
[484235.300000, 4216745.900000],
[484206.400000, 4216765.000000],
[484052.200000, 4216809.700000],
[484088.400000, 4216939.600000],
[484658.800000, 4216707.000000],
[484513.000000, 4216538.800000],
[484489.200000, 4216497.800000],
[484475.100000, 4216469.900000],
[484392.800000, 4216108.200000],
[484441.800000, 4216013.700000],
[484441.600000, 4215898.100000],
[484402.600000, 4215735.300000],
[484319.900000, 4215575.900000],
[484145.400000, 4215545.300000],
[484024.000000, 4215388.900000],
[483929.000000, 4215255.800000],
[483918.500000, 4215251.600000],
[483953.200000, 4215029.700000],
[483952.000000, 4214861.300000],
[484031.100000, 4214481.400000],
[484099.800000, 4214208.300000],
[484154.500000, 4213935.200000],
[484152.600000, 4213808.600000],
[484128.400000, 4213582.200000],
[483295.100000, 4213414.600000],
[483356.000000, 4213578.700000],
[483338.400000, 4213609.600000],
[483324.100000, 4213527.100000],
[483389.200000, 4213644.700000],
[483394.000000, 4213845.300000],
[483386.400000, 4214008.200000],
[483412.000000, 4214081.400000],
[483560.000000, 4214378.700000],
[483671.300000, 4214732.300000],
[483758.800000, 4215108.400000],
[483885.600000, 4215372.300000],
[484106.200000, 4215596.200000],
[484326.900000, 4215911.900000],
[484461.800000, 4216332.400000],
[484676.400000, 4216712.500000],
[484752.700000, 4216823.700000],
[484546.300000, 4216616.600000],
[484565.800000, 4216775.300000],
[484581.100000, 4216970.400000],
[484090.000000, 4216944.300000],
[484077.600000, 4216819.900000],
[484222.200000, 4216770.900000],
[484231.800000, 4216765.400000],
[484282.700000, 4216802.100000],
[484388.700000, 4216753.200000],
[484492.000000, 4216649.800000],
[484565.500000, 4216620.800000],
[484703.100000, 4216601.500000],
[484605.600000, 4216474.300000],
[484757.100000, 4216379.600000],
[484778.000000, 4216297.500000],
[484783.200000, 4216287.300000],
[484791.000000, 4216271.700000],
[484758.800000, 4216403.800000],
[484526.700000, 4216502.000000],
[484513.500000, 4216508.800000],
[484485.300000, 4216491.000000],
[484461.500000, 4216419.100000],
[484411.100000, 4216246.100000],
[484400.600000, 4216259.300000],
[484310.100000, 4216320.800000],
[484260.900000, 4216296.400000],
[484402.700000, 4216231.700000],
[484382.300000, 4216119.600000],
[484443.500000, 4216027.200000],
[484460.200000, 4216017.000000],
[484488.300000, 4216006.800000],
[484476.800000, 4215935.700000],
[484411.800000, 4215889.300000],
[484402.100000, 4215890.600000],
[484399.400000, 4215876.200000],
[484403.300000, 4215664.200000],
[484305.900000, 4215597.900000],
[484140.000000, 4215544.000000],
[484027.600000, 4215425.700000],
[484024.000000, 4215405.800000],
[483963.300000, 4215310.700000],
[483921.000000, 4215265.500000],
[483951.100000, 4214924.700000],
[484043.300000, 4214466.200000],
[484099.900000, 4214241.700000],
[484136.400000, 4214097.300000],
[484165.000000, 4213908.500000],
[484152.500000, 4213760.000000],
[484157.200000, 4213721.400000],
[484164.700000, 4213945.800000],
[484121.300000, 4214151.100000],
[484040.200000, 4214463.200000],
[483962.800000, 4214819.300000],
[484002.100000, 4215155.300000],
[484088.300000, 4215283.800000],
[484113.100000, 4215370.100000],
[484081.500000, 4215388.000000],
[484093.100000, 4215484.400000],
[484281.700000, 4215575.100000],
[484452.900000, 4215672.500000],
[484534.800000, 4215863.300000],
[484541.300000, 4216013.100000],
[484517.000000, 4216132.900000],
[484517.000000, 4216135.000000],
[484523.200000, 4216191.700000],
[484575.200000, 4216350.400000],
[484670.000000, 4216430.200000],
[484778.500000, 4216317.800000],
[484784.700000, 4216289.900000],
[484805.600000, 4216231.000000],
[484770.800000, 4216384.300000],
[484579.000000, 4216474.400000],
[484544.900000, 4216493.500000],
[484518.700000, 4216505.800000],
[484517.800000, 4216507.900000],
[484488.000000, 4216497.800000],
[484451.000000, 4216376.000000],
[484407.800000, 4216249.500000],
[484403.500000, 4216252.900000],
[484273.100000, 4216383.900000],
[484111.100000, 4216480.800000],
[484072.200000, 4216352.200000],
[484000.200000, 4216345.500000],
[483917.000000, 4216365.600000],
[483956.000000, 4216533.100000],
[484008.000000, 4216706.100000],
[484080.700000, 4216675.900000],
[484206.900000, 4216660.000000],
[484238.700000, 4216755.200000],
[484211.500000, 4216776.400000],
[484045.000000, 4216833.500000],
[484140.000000, 4213473.400000],
[484159.700000, 4213706.600000],
[484164.200000, 4213754.400000],
[484174.100000, 4213854.300000],
[484150.400000, 4213876.400000],
[483903.100000, 4213895.900000],
[483611.900000, 4213926.500000],
[483452.400000, 4213944.600000],
[483452.400000, 4213951.400000],
[483286.700000, 4213972.900000],
[483050.800000, 4214001.300000],
[483022.700000, 4214005.600000],
[483004.400000, 4214012.400000],
[482998.100000, 4213982.400000],
[482997.200000, 4213945.500000],
[482913.800000, 4213930.100000],
[482705.100000, 4213936.000000],
[484746.000000, 4216801.200000],
[484579.900000, 4216633.900000],
[484458.400000, 4216384.400000],
[484394.800000, 4216117.100000],
[484445.500000, 4216021.700000],
[484435.600000, 4215894.300000],
[484405.400000, 4215705.600000],
[484330.600000, 4215581.300000],
[484158.600000, 4215559.700000],
[484025.800000, 4215388.100000],
[483929.000000, 4215252.800000],
[483954.000000, 4215034.400000],
[483952.400000, 4215034.400000],
[483976.400000, 4214740.200000],
[484071.100000, 4214327.300000],
[484091.200000, 4214236.300000],
[484139.000000, 4214045.300000],
[484150.800000, 4213831.100000],
[484140.900000, 4213731.200000],
[483275.700000, 4213448.900000],
[483296.100000, 4213514.500000],
[483304.000000, 4213536.500000],
[483342.800000, 4213606.200000],
[483355.500000, 4213843.700000],
[483410.400000, 4214120.800000],
[483537.200000, 4214386.800000],
[483585.800000, 4214569.900000],
[483707.400000, 4214826.200000],
[483741.900000, 4214990.300000],
[483805.400000, 4215257.700000],
[483817.700000, 4215284.400000],
[483986.500000, 4215476.200000],
[484072.700000, 4215591.600000],
[484296.900000, 4215908.600000],
[484432.700000, 4216329.000000],
[484527.800000, 4216569.700000],
[484771.100000, 4216830.000000],
[484825.600000, 4216900.100000],
[484587.500000, 4216645.300000],
[484483.700000, 4216482.600000],
[484479.300000, 4216459.300000],
[484407.000000, 4216268.600000],
[484381.400000, 4216277.100000],
[484314.000000, 4216357.200000],
[484300.600000, 4216276.400000],
[484419.800000, 4216231.700000],
[484380.900000, 4216094.200000],
[484461.400000, 4216022.100000],
[484505.900000, 4215961.900000],
[484403.100000, 4215817.000000],
[484364.100000, 4215591.900000],
[484188.600000, 4215581.200000],
[484042.800000, 4215437.100000],
[484015.400000, 4215386.000000],
[483922.200000, 4215241.800000],
[483955.000000, 4215017.400000],
[483952.200000, 4214954.400000],
[483952.200000, 4214927.700000],
[483991.200000, 4214709.200000],
[483996.400000, 4214692.700000],
[484037.100000, 4214492.900000],
[484090.300000, 4214292.100000],
[484132.900000, 4214135.400000],
[484162.400000, 4213941.100000],
[484165.000000, 4213914.400000],
[484147.800000, 4213659.200000],
[484124.400000, 4213445.500000],
[484158.500000, 4213853.900000],
[484160.200000, 4213880.600000],
[483978.800000, 4213911.000000],
[483671.900000, 4213939.500000],
[483336.800000, 4213971.100000],
[483120.300000, 4213996.100000],
[483005.300000, 4214008.600000],
[482985.000000, 4213974.400000],
[482990.100000, 4213929.100000],
[482987.500000, 4213929.100000],
[482942.700000, 4213904.600000],
[482685.000000, 4213930.500000],
[482445.600000, 4213952.200000],
[482436.500000, 4215395.100000],
[482558.100000, 4215616.600000],
[482679.700000, 4215845.000000],
[482872.900000, 4216039.700000],
[483011.700000, 4216191.300000],
[483119.000000, 4216317.700000],
[483115.700000, 4216409.900000],
[483115.700000, 4216413.300000],
[483066.600000, 4216455.800000],
[483096.700000, 4216633.000000],
[483184.500000, 4216689.600000],
[483342.200000, 4216629.200000],
[483675.900000, 4216893.900000],
[484792.100000, 4216857.400000],
[484512.700000, 4216551.500000],
[484499.400000, 4216507.100000],
[484439.200000, 4216252.000000],
[484449.300000, 4216023.400000],
[484456.100000, 4215902.400000],
[484416.400000, 4215756.000000],
[484330.100000, 4215586.400000],
[484138.000000, 4215539.000000],
[483993.800000, 4215359.300000],
[483931.300000, 4215209.600000],
[483973.400000, 4214770.200000],
[484076.100000, 4214310.800000],
[484141.300000, 4214066.400000],
[484148.700000, 4213826.900000],
[484150.300000, 4213750.200000],
[483300.100000, 4213441.300000],
[483396.100000, 4213671.700000],
[483390.200000, 4213810.600000],
[483378.200000, 4213896.900000],
[483496.400000, 4214227.300000],
[483613.700000, 4214569.900000],
[483754.700000, 4214899.300000],
[483793.900000, 4215195.500000],
[483954.000000, 4215431.400000],
[484135.000000, 4215615.100000],
[484369.000000, 4215985.500000],
[484491.700000, 4216420.400000],
[484772.100000, 4216812.600000],
	[484931.800000, 4216987.500000],
	[484720.200000, 4216889.300000],
	[484059.800000, 4216897.300000],
	[484172.700000, 4216804.000000],
	[484230.500000, 4216770.500000],
    ];
    
    // Update the Hausdorff distance
    drawH2( );
    // Draw the new sample
    drawSample( );
    $('input.rips.scale').trigger("change");
}

// Computes Complexes
var Complex = {
    rips: function(scale) {
	simplices=[d3.range(sample.length),[],[]];
	adjRips = new Array(sample.length);
	dEps = new Array(sample.length);
	
	for(var i = 0; i < adjRips.length; i++) {
	    adjRips[i]= new Array(sample.length);
	    
	    for(var j = 0; j < adjRips.length; j++) {
		var d = dist2(sample[i],sample[j]); 
		if( d < scale) {
		    adjRips[i][j]=d;
		    if(i<j)
    	 		simplices[1].push([i,j]);
		}
		else
		    adjRips[i][j]=0;
	    }
	}
	for(var i = 0; i < adjRips.length; i++ ){
	    dEps[i] = dijsktra(adjRips, i);
	}
	combinations(simplices[0],3).forEach(function(d) {
    	    if ( diam2( d3.permute(sample,d) ) < scale )
    		simplices[2].push(d);
	});
	drawComplex( );
	drawBalls(scale/2.0);
	$('input.shadow.scale').val(0);
	$('input.shadow.scale').trigger("change");
    },
    cech: function(scale) {
	simplices[0]  = d3.range(sample.length);
	simplices[1]  = [];
	simplices[2]  = [];
	
	combinations(simplices[0],2).forEach(function(d) {
    	    if ( diam2( d3.permute(sample,d) ) < 2*scale )
    		simplices[1].push(d);
	});
	
	combinations(simplices[0],3).forEach(function(d) {
	    if ( circRad2( d3.permute(sample,d) ) < scale )
    		simplices[2].push(d);
	});
	
	drawBalls(scale);
	drawComplex( );
    },
    shadow: function(scale) {
	shadow=[d3.range(sample.length),[],[]];
	combinations(shadow[0],2).forEach(function(d) {
	    if ( dEps[d[0]][d[1]] < scale)
    		shadow[1].push(d);
	});
	combinations(shadow[0],3).forEach(function(d) {
	    if ( dEps[d[0]][d[1]] < scale && dEps[d[1]][d[2]] < scale &&
	       dEps[d[0]][d[2]] < scale)
    		shadow[2].push(d);
	});
	drawShadow( );
    },
    
}

// Dijsktra
function dijsktra(adj, src) {
    var dist= new Array(adj.length);
    var sptSet = new Array(adj.length);

    for(var i = 0; i < adj.length; i++ ) 
	dist[i] = Infinity; sptSet[i] = false;

    dist[src] = 0;
    
    for(var count = 0; count < adj.length - 1; count++ ) {
	var min = Infinity, min_index; 
	for(v = 0; v < adj.length; v++) 
            if (!sptSet[v] && dist[v] <= min) 
		min = dist[v], min_index = v; 
	sptSet[min_index] = true;
	
	for(var v = 0; v < adj.length; v++)
	    if(!sptSet[v] && adj[min_index][v] && dist[min_index] != Infinity 
               && dist[min_index] + adj[min_index][v] < dist[v])
		dist[v] = dist[min_index] + adj[min_index][v]; 
	
    }
    return dist;
}

var Shape = {
    // Lissajous
    lissajous: function(center,a=center[0]-100,b=center[1]-100,
			kx=3,ky=2,n=500) {
	var t = d3.range(n).map(function(d) {
  	    return 2*Math.PI*d/(n-1);
	});
	var points = [];
	for(var i=0; i<n; i++) {
  	    points[i] = [center[0] + a*Math.cos(kx*t[i]), 
  			 center[1] + b*Math.sin(ky*t[i])];
	}
	return points;
    },
    
    // Lemniscate 
    lemniscate: function(center,a=center[0]-100,n=500) {
	var t = d3.range(n).map(function(d) {
  	    return 2*Math.PI*d/(n-1);
	});
	var points = [];
	for(var i=0; i<n; i++) {
  	    points[i] = [center[0] +
			 a*Math.cos(t[i])/(1 + Math.pow(Math.sin(t[i]),2)), 
  			 center[1] + a*Math.sin(t[i])*Math.cos(t[i])/
			 (1 + Math.pow(Math.sin(t[i]),2))];
	}
	return points;
    },
    
    // Circle
    circle: function(center,radius=Math.min(...center)-100, range=[0,1], n=500) {
	var t = d3.range(n).map(function(d) {
  	    return range[0] + (range[1]-range[0])*d/(n-1);
	}); 
	var points = [];
	for(var i=0; i<n; i++) {
  	    points[i] = [center[0] + radius*Math.cos(2*Math.PI*t[i]), 
  			 center[1] + radius*Math.sin(2*Math.PI*t[i])];
	}
	return points;
    }
}

// Compute Euclidean distance of two points in 2D 
function dist2(a,b){
    if( a.length != b.length || a.length != 2 )
	return null;
    return Math.sqrt( Math.pow(a[0]-b[0],2) + Math.pow(a[1]-b[1],2) );
}

// Compute dist2 diameter of points in 2D
function diam2(points) {
    var diam = 0;
    points.forEach(function(p) {
	points.forEach(function(q) {
	    diam = Math.max(diam, dist2(p,q));
	});
    });
    return diam;
}

// Compute Circumradius
function circRad2(A) {
    var cg = [0,0]; var n = A.length + 0.0;
    A.forEach(function(a) {
	cg[0] = cg[0] + a[0]/n;
	cg[1] = cg[1] + a[1]/n;
    });
    return Math.max(dist2(cg, A[0]),dist2(cg, A[1]),dist2(cg, A[2]));
}

// Compute Hausdorff distance in 2D
function H2(A,B) {
    var d1=0, d2=0;
    points = [];
    
    // Return if the sets are empty
    if(A.length==0 || B.length==0)
    	return [undefined,points];
    
    // Distance A to B
    A.forEach(function(a) {
   	var k=Infinity;
	var nn;
	B.forEach(function(b) {
	    if( dist2(a,b) < k ) {
		k = dist2(a,b);
		nn = b;
	    }
	});
	if( k >= d1 ) {
	    d1 = k;
	    points[0] = [a,nn];
	}
    });
    
    // Distance B to A
    B.forEach(function(b) {
   	var k=Infinity;
	var nn;	
	A.forEach(function(a) {
    	    if( dist2(a,b) < k ) {
		k = dist2(a,b);
		nn = a;
	    }
	});
	if( k >= d2 ) {
	    d2 = k;
	    points[1] = [b,nn];
	}
    });
    return [Math.max(d1,d2),points];
}

// Compute all combinations of k elements from a set
function combinations(set, k) {
    var i, j, combs, head, tailcombs;
    if (k > set.length || k <= 0) {
	return [];
    }
    if (k == set.length) {
	return [set];
    }
    if (k == 1) {
	combs = [];
	for (i = 0; i < set.length; i++) {
	    combs.push([set[i]]);
	}
	return combs;
    }
    combs = [];
    for (i = 0; i < set.length - k + 1; i++) {
	head = set.slice(i, i + 1);
	tailcombs = combinations(set.slice(i + 1), k - 1);
	for (j = 0; j < tailcombs.length; j++) {
	    combs.push(head.concat(tailcombs[j]));
	}
    }
    return combs
}

// Save SVG
function saveSVG(e) {
    var blob = new Blob([$('.drawing.segment svg').prop('outerHTML')],
			{type: 'image/svg'})
    e.href = URL.createObjectURL(blob);
    e.download = 'drawing.svg';
}
